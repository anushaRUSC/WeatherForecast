<html lang="en">
    <head>
        
          <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
          <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
            <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
            <script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
            <script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.9/jquery.validate.min.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.min.js"></script>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.4.1/moment-timezone-with-data.js"></script>
           <script src="http://openlayers.org/api/OpenLayers.js"></script>
<style>
        body{
            background:url('Web8_images/bg.jpg'); 
            background-repeat: no-repeat;
            background-size: cover;
            
            background-attachment:fixed;
            
            }
        h2{
            text-align:center;}
        
        .fieldset{
       
        background-color: rgba(0,0,0,0.2);
        padding:10px;
        }
        

        label.error {
            color: red;
        }
        
        .borderless th, .borderless td { 
     border-top: none !important; 
            }
        
        .table-striped > tbody > tr:nth-child(2n+1) > td, .table-striped > tbody > tr:nth-child(2n+1) > th  {
   background-color: white;
}
        
        .table-striped > tbody > tr:nth-child(2n) > td, .table-striped > tbody > tr:nth-child(2n) > th {
   background-color: #ffccff;
       
}
        .tabHeading{
        color: white;
        background-color: #146296;
        }
        
        .th{
        text-align: center;
        }


     .nav-tabs>li>a {
                      background-color: white; 
                      text-color: white;
                    }
    
    .nav-tabs>li.active>a, .nav-tabs>li.active>a:focus{
                      color: #fff;
                      background-color: #146296;
                      border-color: white;
                    }

    </style>
     <script type='text/javascript'>
			
			$(document).ready(function() { 
			$("#myForm").validate({ 
	        rules: { 
	          stAddr:{required:true},
	          city: {required:true},
              state: {selectcheck: true}
              
            },
			messages:{
			stAddr:"Please enter the street adress",
			city: "Please enter the city"
  
          }
          })

        jQuery.validator.addMethod('selectcheck', function (value) {
        return (value != '0');
    }, "Please enter the state");

        $('#myForm').submit(function(event) {
        
         event.preventDefault();

        // get the form data   
                 var formData= {
                     'address'   :$('input[name=stAddr]').val(),
                     'city'      :$('input[name=city]').val(),
                     'state'     :$('#state').val(),
                     'degree'    :$('input[name=degree]:checked','#myForm').val(),
                 };
                
                $.ajax({
            type        : 'GET', 
            url         : 'Web_server.php', 
            //url         : 'server.php', 
            data        : formData, 

                      
        })
            
            .done(function(data) {
                
                    try{
              var obj = jQuery.parseJSON(data);
                        
                        var addr= document.getElementById("stAddr").value;
                        var stree= document.getElementById("state").value;
                        var cit= document.getElementById("city").value;
                        
                        if( addr=="" || stree=="" || cit=="")
                        { $('#dataFind').removeClass('hidden');
                            $('#dataFind').removeClass('clear');
                            $('#dataFind').addClass('clear hidden');
                            $('#catchError').addClass('hidden');
                        }
                        else {
                      $('#dataFind').removeClass('hidden');
                    $('#dataFind').removeClass('clear');
                    $('#dataFind').addClass('clear');

                    $('#catchError').addClass('hidden');
                        
                        
                        }
                    } catch(e){
                        $('#catchError').removeClass('hidden');
                        $('#catchError').addClass('errorcatch');
                        document.getElementById("catchError").innerHTML = "Please enter a Valid Address";
                        $('#dataFind').addClass('hidden');
                    }
                    
                    console.log(data);
                    var degree ="";
                    var displayDeg="";
                    var tempUnit="";

                        var radioButtons = document.getElementsByName("degree");
                        for (var x = 0; x < radioButtons.length; x ++) {
                            if (radioButtons[x].checked) {
                                displayDeg= radioButtons[x].value;
                                      }
                                      }

                    var state = document.getElementById("state").value;
                    var city = document.getElementById("city").value;
                    var summary=obj["currently"]["summary"];
                    var icon=obj["currently"]["icon"];
                    var timezone=obj["timezone"];
                    var temp=Math.round(obj["currently"]["temperature"]);
                    var icon=obj["currently"]["icon"];
                    var summary=obj["currently"]["summary"];
                    var precipitation=obj["currently"]["precipIntensity"];
                    var chanceOfRain=((obj["currently"]["precipProbability"])*100).toFixed();
                    var windSpeed=obj["currently"]["windSpeed"];
                    var dewPoint=obj["currently"]["dewPoint"];
                    var humidity=(obj["currently"]["humidity"])*100;
                    var visibility=obj["currently"]["visibility"];
                    var minTemp=Math.round(obj["daily"]["data"][0]["temperatureMin"]);
                    var maxTemp=Math.round(obj["daily"]["data"][0]["temperatureMax"]);
                    var displayUnit="";
                    var iconDisp="";
                    var precipDisplay="";
                    var pressureUnit="";
                    var sunrise=obj["daily"]["data"][0]["sunriseTime"];
                    var sunset=obj["daily"]["data"][0]["sunsetTime"];
                    var rise = moment.unix(sunrise);
                    var local   =  moment.tz(rise, "America/Los_Angeles");
                    var ti=rise.tz(timezone).format('hh:mm A');
                       sunrise = ti;

                    var set = moment.unix(sunset);
                    var local   =  moment.tz(set, "America/Los_Angeles");
                    var ti1=set.tz(timezone).format('hh:mm A');
                    sunset = ti1;
                    var lat=obj["latitude"];
                    var long=obj["longitude"];
                    var imageTab3="";
                    var tab3="";  
                    var tab3Modal="";
                    var tab3Data="";
                    
                    
                   switch(icon)
    {
        case "clear-day": displayIcon= "<img src=\"Web8_images/clear.png\" alt=\""+summary+"\" title=\""+summary+"\" width=\"150\" height=\"130\" style=\"padding:20\">";
            fbIcon="Web8_images/clear.png";
            break;
            
        case "clear-night" : displayIcon="<img src=\"Web8_images/clear_night.png\" alt=\""+summary+"\" title=\""+summary+"\" width=\"150\" height=\"130\" style=\"padding:20\">"; 
            fbIcon="Web8_images/clear_night.png";
            break;
            
        case "rain" : displayIcon="<img src=\"Web8_images/rain.png\" alt=\""+summary+"\" title=\""+summary+"\" width=\"150\" height=\"130\" style=\"padding:20\">"; 
            fbIcon="Web8_images/rain.png";
            break;
            
        case "snow" : displayIcon="<img src=\"Web8_images/snow.png\" alt=\""+summary+"\" title=\""+summary+"\" width=\"150\" height=\"130\" style=\"padding:20\">"; 
            fbIcon="Web8_images/snow.png";
            break;
            
        case "sleet" : displayIcon="<img src=\"Web8_images/sleet.png\" alt=\""+summary+"\" title=\""+summary+"\" width=\"150\" height=\"130\" style=\"padding:20\" >"; 
            fbIcon="Web8_images/sleet.png";
            break;
            
        case "wind" : displayIcon="<img src=\"Web8_images/wind.png\" alt=\""+summary+"\" title=\""+summary+"\" width=\"150\" height=\"130\" style=\"padding:20\">";
            fbIcon="Web8_images/wind.png";
            break;
            
        case "fog" : displayIcon="<img src=\"Web8_images/fog.png\" alt=\""+summary+"\" title=\""+summary+"\" width=\"150\" height=\"130\" style=\"padding:20\" >";
            fbIcon="Web8_images/fog.png";
            break;
            
        case "cloudy" : displayIcon="<img src=\"Web8_images/cloudy.png\" alt=\""+summary+"\" title=\""+summary+"\" width=\"150\" height=\"130\" style=\"padding:20\">"; 
            fbIcon="Web8_images/cloudy.png";
            break;
            
        case "partly-cloudy-day" : displayIcon="<img src=\"Web8_images/cloud_day.png\" alt=\""+summary+"\" title=\""+summary+"\" width=\"150\" height=\"130\" style=\"padding:20\">"; 
            fbIcon="Web8_images/cloud_day.png";
            break;
            
        case "partly-cloudy-night" : displayIcon="<img src=\"Web8_images/cloud_night.png\" alt=\""+summary+"\" title=\""+summary+"\" width=\"150\" height=\"130\" style=\"padding:20\">"; 
            break;

    }
   
                    if(displayDeg=="fahrenheit")
                    { tempUnit="F";
                     
                        windSpeedUnit=" mph";
                        visibilityUnit=" mi";
                        pressureUnit="mb";   
                        if( (0<=precipitation) && (precipitation< 0.002))
                            precipDisplay="None";
                        if( (0.002<=precipitation) && (precipitation< 0.017))
                            precipDisplay="Very Light";
                        if( (0.017<=precipitation) && (precipitation< 0.1))
                            precipDisplay="Light";
                        if( (0.1<=precipitation) && (precipitation< 0.4))
                            precipDisplay="Moderate";
                        if( 0.4<= precipitation)
                            precipDisplay="Heavy";
     
                    }
                    
                    if(displayDeg == "celsius")
                    {
                     tempUnit="C";
                        
                        windSpeedUnit=" m/s";
                        visibilityUnit=" km";
                        pressureUnit="hPa"; 
                        if( (0<=precipitation) && (precipitation< 0.0508))
                            precipDisplay="None";
                        if( (0.0508<=precipitation) && (precipitation< 0.017))
                            precipDisplay="Very Light";
                        if( (0.4318<=precipitation) && (precipitation< 2.54))
                            precipDisplay="Light";
                        if( (2.54<=precipitation) && (precipitation< 10.16))
                            precipDisplay="Moderate";
                        if( 10.16<= precipitation)
                            precipDisplay="Heavy";
                    }


                  
            var printTemp= "<div class=\"short-div\"><font color=\"white\">"+summary+" in "+city+","+state+"</div>"+"<div class=\"short-div\"><font size=\"9\">"+temp+"</font>"+"<sup style=\"font-size:50px\"><font size=\"2\" style=\"padding-top:2px\">"+"&deg"+tempUnit+"</font></sup>"+"</font></div>";
            printTemp+="<div class=\"short-div\"><font size=\"2\" color=\"blue\">L:"+minTemp+"&deg</font>"+" | "+"<font size=\"2\" color=\"green\">H:"+maxTemp+"&deg</font>";
             
            printTemp+= "<button class=\"btn btn-default pull-right\" id=\"fbButton\" style=\"padding:0\" align=\"right\">";
            printTemp+="<img src=\"Web8_images/fb_icon.png\" height=\"25\" width=\"25\" ></button></div>";
                
            
                var table1="<table class=\"table table-striped\" style=\"font-size:13\" ><tbody>";
                table1+="<tr><td>Precipitation</td><td>"+precipDisplay+"</td></tr>";
                table1+="<tr><td>Chance of rain</td><td>"+chanceOfRain+"%</td></tr>";
                table1+="<tr><td>Wind Speed</td><td>"+windSpeed+windSpeedUnit+"</td></tr>";
                table1+="<tr><td>Dew Point</td><td>"+dewPoint+"&deg"+tempUnit+"</td></tr>";
                table1+="<tr><td>Humidity</td><td>"+humidity+"%</td></tr>";
                table1+="<tr><td>Visibility</td><td>"+visibility+visibilityUnit+"</td></tr>";
                table1+="<tr><td>Sunrise</td><td>"+sunrise+"</td></tr>";
                table1+="<tr><td>Sunset</td><td>"+sunset+"</td></tr></tbody></table>";
                
                    
                var table2="<table class=\"table\"><tbody style=\"background-color:white\"><tr class=\"tabHeading\"><td class=\"text-center\">Time</td><td class=\"text-center\">Summary</td><td class=\"text-center\">Cloud Cover</td><td class=\"text-center\">Temp"+"("+"&deg"+tempUnit+")"+"</td><td class=\"text-center\">View Details</td></tr><tr style=\"background-color:white\"><td></td><td></td><td></td><td></td><td></td></tr>";
                    var i=0;
                    for( i=0;i<24;i++)
                    {
                        var hourlyTime=obj["hourly"]["data"][i]["time"];
                        var set = moment.unix(hourlyTime);
                        var local   =  moment.tz(set, "America/Los_Angeles");
                        var ti=set.tz(timezone).format('hh:mm A');
                        hourlyTime = ti;
                        var forIcon=obj["hourly"]["data"][i]["icon"];
                        var forSummary=obj["hourly"]["data"][i]["summary"];
                        var forCloudCover=obj["hourly"]["data"][i]["cloudCover"];
                        var forTemperature=obj["hourly"]["data"][i]["temperature"];
                        var forWindspeedtoggle=obj["hourly"]["data"][i]["windSpeed"];
                        var forHumiditytoggle=Math.round((obj["hourly"]["data"][i]["humidity"])*100);
                        var forVisibilitytoggle=obj["hourly"]["data"][i]["visibility"];
                        var forPressuretoggle=obj["hourly"]["data"][i]["pressure"];
                        
                        switch(forIcon)
                    {
             case "clear-day":table2+="<tr style=\"background-color:white\"><td class=\"text-center\">"+hourlyTime+"</td><td class=\"text-center\"><img src=\"Web8_images/clear.png\" alt=\""+forSummary+"\" title=\""+forSummary+"\" width=\"50\" height=\"40\" class=\"text-center\"></td><td class=\"text-center\">"+forCloudCover+"%</td><td class=\"text-center\">"+forTemperature+"</td><td class=\"text-center\"><a class=\"panel panel-default\" style=\"border-color: white\" type=\"button\" data-toggle=\"collapse\" data-target=\"#collapse"+i+"\" aria-expanded=\"false\" aria-controls=\"collapse"+i+"\"><span class=\"glyphicon glyphicon-plus\" style=\"color:#146296\"></span></a></td></tr><tr ><td colspan=\"5\" class=\"well\" ><div class=\"collapse\" id=\"collapse"+i+"\"><table class=\"table table-responsive\" id=\"collapseTwo\" role=\"tabpanel\" aria-labelledby=\"headingTwo\"><tr><th class=\"text-center\">Wind</th><th class=\"text-center\">Humidity</th><th class=\"text-center\">Visibility</th><th class=\"text-center\">Pressure</th></tr><tr class=\"well\"><td class=\"text-center\">"+forWindspeedtoggle+windSpeedUnit+"</td><td class=\"text-center\">"+forHumiditytoggle+"%"+"</td><td class=\"text-center\">"+forVisibilitytoggle+visibilityUnit+"</td><td class=\"text-center\">"+forPressuretoggle+pressureUnit+"</td></tr></table></div></td></tr>"; break;
                            
             case "clear-night":table2+="<tr style=\"background-color:white\"><td class=\"text-center\">"+hourlyTime+"</td><td class=\"text-center\"><img src=\"Web8_images/clear_night.png\" alt=\""+forSummary+"\" title=\""+forSummary+"\" width=\"50\" height=\"40\" class=\"text-center\"></td><td class=\"text-center\">"+forCloudCover+"%</td><td class=\"text-center\">"+forTemperature+"</td><td class=\"text-center\"><a class=\"panel panel-default\" style=\"border-color: white\" type=\"button\" data-toggle=\"collapse\" data-target=\"#collapse"+i+"\" aria-expanded=\"false\" aria-controls=\"collapse"+i+"\"><span class=\"glyphicon glyphicon-plus\" style=\"color:#146296\"></span></a></td></tr><tr ><td colspan=\"5\" class=\"well\" ><div class=\"collapse\" id=\"collapse"+i+"\"><table class=\"table table-responsive\" id=\"collapseTwo\" role=\"tabpanel\" aria-labelledby=\"headingTwo\"><tr><th class=\"text-center\">Wind</th><th class=\"text-center\">Humidity</th><th class=\"text-center\">Visibility</th><th class=\"text-center\">Pressure</th></tr><tr class=\"well\"><td class=\"text-center\">"+forWindspeedtoggle+windSpeedUnit+"</td><td class=\"text-center\">"+forHumiditytoggle+"%"+"</td><td class=\"text-center\">"+forVisibilitytoggle+visibilityUnit+"</td><td class=\"text-center\">"+forPressuretoggle+pressureUnit+"</td></tr></table></div></td></tr>"; break;
                            
           case "rain":table2+="<tr style=\"background-color:white\"><td class=\"text-center\">"+hourlyTime+"</td><td class=\"text-center\"><img src=\"Web8_images/rain.png\" alt=\""+forSummary+"\" title=\""+forSummary+"\" width=\"50\" height=\"40\" class=\"text-center\"></td><td class=\"text-center\">"+forCloudCover+"%</td><td class=\"text-center\">"+forTemperature+"</td><td class=\"text-center\"><a class=\"panel panel-default\" style=\"border-color: white\" type=\"button\" data-toggle=\"collapse\" data-target=\"#collapse"+i+"\" aria-expanded=\"false\" aria-controls=\"collapse"+i+"\"><span class=\"glyphicon glyphicon-plus\" style=\"color:#146296\"></span></a></td></tr><tr ><td colspan=\"5\" class=\"well\" ><div class=\"collapse\" id=\"collapse"+i+"\"><table class=\"table table-responsive\" id=\"collapseTwo\" role=\"tabpanel\" aria-labelledby=\"headingTwo\"><tr><th class=\"text-center\">Wind</th><th class=\"text-center\">Humidity</th><th class=\"text-center\">Visibility</th><th class=\"text-center\">Pressure</th></tr><tr class=\"well\"><td class=\"text-center\">"+forWindspeedtoggle+windSpeedUnit+"</td><td class=\"text-center\">"+forHumiditytoggle+"%</td><td class=\"text-center\">"+forVisibilitytoggle+visibilityUnit+"</td><td class=\"text-center\">"+forPressuretoggle+pressureUnit+"</td></tr></table></div></td></tr>"; break;
                            
                case "clear-night":table2+="<tr style=\"background-color:white\"><td class=\"text-center\">"+hourlyTime+"</td><td class=\"text-center\"><img src=\"Web8_images/clear_night.png\" alt=\""+forSummary+"\" title=\""+forSummary+"\" width=\"50\" height=\"40\" class=\"text-center\"></td><td class=\"text-center\">"+forCloudCover+"%</td><td class=\"text-center\">"+forTemperature+"</td><td class=\"text-center\"><a class=\"panel panel-default\" style=\"border-color: white\" type=\"button\" data-toggle=\"collapse\" data-target=\"#collapse"+i+"\" aria-expanded=\"false\" aria-controls=\"collapse"+i+"\"><span class=\"glyphicon glyphicon-plus\" style=\"color:#146296\"></span></a></td></tr><tr ><td colspan=\"5\" class=\"well\" ><div class=\"collapse\" id=\"collapse"+i+"\"><table class=\"table table-responsive\" id=\"collapseTwo\" role=\"tabpanel\" aria-labelledby=\"headingTwo\"><tr><th class=\"text-center\">Wind</th><th class=\"text-center\">Humidity</th><th class=\"text-center\">Visibility</th><th class=\"text-center\">Pressure</th></tr><tr class=\"well\"><td class=\"text-center\">"+forWindspeedtoggle+windSpeedUnit+"</td><td class=\"text-center\">"+forHumiditytoggle+"%</td><td class=\"text-center\">"+forVisibilitytoggle+visibilityUnit+"</td><td class=\"text-center\">"+forPressuretoggle+pressureUnit+"</td></tr></table></div></td></tr>"; break;
                            
              case "snow":table2+="<tr style=\"background-color:white\"><td class=\"text-center\">"+hourlyTime+"</td><td class=\"text-center\"><img src=\"Web8_images/snow.png\" alt=\""+forSummary+"\" title=\""+forSummary+"\" width=\"50\" height=\"40\" class=\"text-center\"></td><td class=\"text-center\">"+forCloudCover+"%</td><td class=\"text-center\">"+forTemperature+"</td><td class=\"text-center\"><a class=\"panel panel-default\" style=\"border-color: white\" type=\"button\" data-toggle=\"collapse\" data-target=\"#collapse"+i+"\" aria-expanded=\"false\" aria-controls=\"collapse"+i+"\"><span class=\"glyphicon glyphicon-plus\" style=\"color:#146296\"></span></a></td></tr><tr ><td colspan=\"5\" class=\"well\" ><div class=\"collapse\" id=\"collapse"+i+"\"><table class=\"table table-responsive\" id=\"collapseTwo\" role=\"tabpanel\" aria-labelledby=\"headingTwo\"><tr><th class=\"text-center\">Wind</th><th class=\"text-center\">Humidity</th><th class=\"text-center\">Visibility</th><th class=\"text-center\">Pressure</th></tr><tr class=\"well\"><td class=\"text-center\">"+forWindspeedtoggle+windSpeedUnit+"</td><td class=\"text-center\">"+forHumiditytoggle+"%</td><td class=\"text-center\">"+forVisibilitytoggle+visibilityUnit+"</td><td class=\"text-center\">"+forPressuretoggle+pressureUnit+"</td></tr></table></div></td></tr>"; break;
                            
                            
              case "sleet":table2+="<tr style=\"background-color:white\"><td class=\"text-center\">"+hourlyTime+"</td><td class=\"text-center\"><img src=\"Web8_images/sleet.png\" alt=\""+forSummary+"\" title=\""+forSummary+"\" width=\"50\" height=\"40\" class=\"text-center\"></td><td class=\"text-center\">"+forCloudCover+"%</td><td class=\"text-center\">"+forTemperature+"</td><td class=\"text-center\"><a class=\"panel panel-default\" style=\"border-color: white\" type=\"button\" data-toggle=\"collapse\" data-target=\"#collapse"+i+"\" aria-expanded=\"false\" aria-controls=\"collapse"+i+"\"><span class=\"glyphicon glyphicon-plus\" style=\"color:#146296\"></span></a></td></tr><tr ><td colspan=\"5\" class=\"well\" ><div class=\"collapse\" id=\"collapse"+i+"\"><table class=\"table table-responsive\" id=\"collapseTwo\" role=\"tabpanel\" aria-labelledby=\"headingTwo\"><tr><th class=\"text-center\">Wind</th><th class=\"text-center\">Humidity</th><th class=\"text-center\">Visibility</th><th class=\"text-center\">Pressure</th></tr><tr class=\"well\"><td class=\"text-center\">"+forWindspeedtoggle+windSpeedUnit+"</td><td class=\"text-center\">"+forHumiditytoggle+"%</td><td class=\"text-center\">"+forVisibilitytoggle+visibilityUnit+"</td><td class=\"text-center\">"+forPressuretoggle+pressureUnit+"</td></tr></table></div></td></tr>"; break;
                            
              case "wind":table2+="<tr style=\"background-color:white\"><td class=\"text-center\">"+hourlyTime+"</td><td class=\"text-center\"><img src=\"Web8_images/wind.png\" alt=\""+forSummary+"\" title=\""+forSummary+"\" width=\"50\" height=\"40\" class=\"text-center\"></td><td class=\"text-center\">"+forCloudCover+"%</td><td class=\"text-center\">"+forTemperature+"</td><td class=\"text-center\"><a class=\"panel panel-default\" style=\"border-color: white\" type=\"button\" data-toggle=\"collapse\" data-target=\"#collapse"+i+"\" aria-expanded=\"false\" aria-controls=\"collapse"+i+"\"><span class=\"glyphicon glyphicon-plus\" style=\"color:#146296\"></span></a></td></tr><tr ><td colspan=\"5\" class=\"well\" ><div class=\"collapse\" id=\"collapse"+i+"\"><table class=\"table table-responsive\" id=\"collapseTwo\" role=\"tabpanel\" aria-labelledby=\"headingTwo\"><tr><th class=\"text-center\">Wind</th><th class=\"text-center\">Humidity</th><th class=\"text-center\">Visibility</th><th class=\"text-center\">Pressure</th></tr><tr class=\"well\"><td class=\"text-center\">"+forWindspeedtoggle+windSpeedUnit+"</td><td class=\"text-center\">"+forHumiditytoggle+"%</td><td class=\"text-center\">"+forVisibilitytoggle+visibilityUnit+"</td><td class=\"text-center\">"+forPressuretoggle+pressureUnit+"</td></tr></table></div></td></tr>"; break;
                            
           case "cloudy":table2+="<tr style=\"background-color:white\"><td class=\"text-center\">"+hourlyTime+"</td><td class=\"text-center\"><img src=\"Web8_images/cloudy.png\" alt=\""+forSummary+"\" title=\""+forSummary+"\" width=\"50\" height=\"40\" class=\"text-center\"></td><td class=\"text-center\">"+forCloudCover+"%</td><td class=\"text-center\">"+forTemperature+"</td><td class=\"text-center\"><a class=\"panel panel-default\" style=\"border-color: white\" type=\"button\" data-toggle=\"collapse\" data-target=\"#collapse"+i+"\" aria-expanded=\"false\" aria-controls=\"collapse"+i+"\"><span class=\"glyphicon glyphicon-plus\" style=\"color:#146296\"></span></a></td></tr><tr ><td colspan=\"5\" class=\"well\" ><div class=\"collapse\" id=\"collapse"+i+"\"><table class=\"table table-responsive\" id=\"collapseTwo\" role=\"tabpanel\" aria-labelledby=\"headingTwo\"><tr><th class=\"text-center\">Wind</th><th class=\"text-center\">Humidity</th><th class=\"text-center\">Visibility</th><th class=\"text-center\">Pressure</th></tr><tr class=\"well\"><td class=\"text-center\">"+forWindspeedtoggle+windSpeedUnit+"</td><td class=\"text-center\">"+forHumiditytoggle+"%</td><td class=\"text-center\">"+forVisibilitytoggle+visibilityUnit+"</td><td class=\"text-center\">"+forPressuretoggle+pressureUnit+"</td></tr></table></div></td></tr>"; break;
                            
           case "partly-cloudy-day":table2+="<tr style=\"background-color:white\"><td class=\"text-center\">"+hourlyTime+"</td><td class=\"text-center\"><img src=\"Web8_images/cloud_day.png\" alt=\""+forSummary+"\" title=\""+forSummary+"\" width=\"50\" height=\"40\" class=\"text-center\"></td><td class=\"text-center\">"+forCloudCover+"%</td><td class=\"text-center\">"+forTemperature+"</td><td class=\"text-center\"><a class=\"panel panel-default\" style=\"border-color: white\" type=\"button\" data-toggle=\"collapse\" data-target=\"#collapse"+i+"\" aria-expanded=\"false\" aria-controls=\"collapse"+i+"\"><span class=\"glyphicon glyphicon-plus\" style=\"color:#146296\"></span></a></td></tr><tr ><td colspan=\"5\" class=\"well\" ><div class=\"collapse\" id=\"collapse"+i+"\"><table class=\"table table-responsive\" id=\"collapseTwo\" role=\"tabpanel\" aria-labelledby=\"headingTwo\"><tr><th class=\"text-center\">Wind</th><th class=\"text-center\">Humidity</th><th class=\"text-center\">Visibility</th><th class=\"text-center\">Pressure</th></tr><tr class=\"well\"><td class=\"text-center\">"+forWindspeedtoggle+windSpeedUnit+"</td><td class=\"text-center\">"+forHumiditytoggle+"%</td><td class=\"text-center\">"+forVisibilitytoggle+visibilityUnit+"</td><td class=\"text-center\">"+forPressuretoggle+pressureUnit+"</td></tr></table></div></td></tr>"; break;
                            
                            
                            
           case "partly-cloudy-night":table2+="<tr style=\"background-color:white\"><td class=\"text-center\">"+hourlyTime+"</td><td class=\"text-center\"><img src=\"Web8_images/cloud_night.png\" alt=\""+forSummary+"\" title=\""+forSummary+"\" width=\"50\" height=\"40\" class=\"text-center\"></td><td class=\"text-center\">"+forCloudCover+"%</td><td class=\"text-center\">"+forTemperature+"</td><td class=\"text-center\"><a class=\"panel panel-default\" style=\"border-color: white\" type=\"button\" data-toggle=\"collapse\" data-target=\"#collapse"+i+"\" aria-expanded=\"false\" aria-controls=\"collapse"+i+"\"><span class=\"glyphicon glyphicon-plus\" style=\"color:#146296\"></span></a></td></tr><tr ><td colspan=\"5\" class=\"well\" ><div class=\"collapse\" id=\"collapse"+i+"\"><table class=\"table table-responsive\" id=\"collapseTwo\" role=\"tabpanel\" aria-labelledby=\"headingTwo\"><tr><th class=\"text-center\">Wind</th><th class=\"text-center\">Humidity</th><th class=\"text-center\">Visibility</th><th class=\"text-center\">Pressure</th></tr><tr class=\"well\"><td class=\"text-center\">"+forWindspeedtoggle+windSpeedUnit+"</td><td class=\"text-center\">"+forHumiditytoggle+"%</td><td class=\"text-center\">"+forVisibilitytoggle+visibilityUnit+"</td><td class=\"text-center\">"+forPressuretoggle+pressureUnit+"</td></tr></table></div></td></tr>"; break;

                    }
                    }
      // Tab3    
                    
                
                    var colors=[ "white","#367DB5","#EC4444","E68E4F","#A7A439","#9770A7","#F37C7E","#CE4571"];
                    
                    for(i=1;i<8;i++)
                    {
                        var day=obj["daily"]["data"][i]["time"];
                        var set = moment.unix(day);
                        var ti=set.tz(timezone).format('dddd');
                        day = ti;
                        var date=obj["daily"]["data"][i]["time"];
                        var set = moment.unix(date);
                        var ti=set.tz(timezone).format('MMM DD');
                        date = ti;
                        var tempMin=Math.round(obj["daily"]["data"][i]["temperatureMin"]);
                        var tempMax=Math.round(obj["daily"]["data"][i]["temperatureMax"]);
                        var dailyIcon=obj["daily"]["data"][i]["icon"];
                        var dailySummary=obj["daily"]["data"][i]["summary"];
                        var dailySunrise=obj["daily"]["data"][i]["sunriseTime"];
                        var dailySunset=obj["daily"]["data"][i]["sunsetTime"];
                        
                        dailySunrise = moment.unix(dailySunrise);
                        var ti=dailySunrise.tz(timezone).format('hh:mm A');
                        dailySunrise = ti;
                        
                        
                        dailySunset = moment.unix(dailySunset);
                        var ti1=dailySunset.tz(timezone).format('hh:mm A');
                        dailySunset = ti1;
                        var tab3VisibilityUnit="";
                        
                        var dailyHumidity=  ((obj["daily"]["data"][i]["humidity"])*100).toFixed();
                        dailyHumidity+= "%";
                        var dailyVisibility=obj["daily"]["data"][i]["visibility"];
                        var dailypressure=obj["daily"]["data"][i]["pressure"];
                        var dailyWindSpeed=obj["daily"]["data"][i]["windSpeed"];
                        
                        if(displayDeg=="fahrenheit")
                        {
                          tab3VisibilityUnit=" mi"
                          
                          if( dailyVisibility == undefined)
                            {    dailyVisibility="NaN";
                                tab3VisibilityUnit="";
                            }
                            
                           if(dailyHumidity == undefined)
                               dailyHumidity="NaN"
                        }
                        
                        if(displayDeg=="celsius")
                        {
                          tab3VisibilityUnit=" km"
                          if( dailyVisibility == undefined)
                            {    dailyVisibility="NaN";
                                tab3VisibilityUnit="";
                            }
                            
                            if(dailyHumidity == undefined)
                               dailyHumidity="NaN"
                        }
                        switch(dailyIcon)
                        {
                                case "clear-day": 
            imageTab3="<img src=\"Web8_images/clear.png\" alt=\""+dailySummary+"\" title=\""+dailySummary+"\" width=\"70\" height=\"50\">";
            break;
        case "clear-night" : 
            imageTab3="<img src=\"Web8_images/clear_night.png\" alt=\""+dailySummary+"\" title=\""+dailySummary+"\" width=\"70\" height=\"50\">";
                break;
        case "rain" : 
            imageTab3="<img src=\"Web8_images/rain.png\" alt=\""+dailySummary+"\" title=\""+dailySummary+"\" width=\"70\" height=\"50\">"; 
            break;
        case "snow" : 
            imageTab3="<img src=\"Web8_images/snow.png\" alt=\""+dailySummary+"\" title=\""+dailySummary+"\" width=\"70\" height=\"50\">"; 
                break;
        case "sleet" :
            imageTab3="<img src=\"Web8_images/sleet.png\" alt=\""+dailySummary+"\" title=\""+dailySummary+"\" width=\"70\" height=\"50\">";
            break;
        case "wind" : 
            imageTab3="<img src=\"Web8_images/wind.png\" alt=\""+summary+"\" title=\""+summary+"\" width=\"70\" height=\"50\">";
            break;
        case "fog" :
            imageTab3="<img src=\"Web8_images/fog.png\" alt=\""+dailySummary+"\" title=\""+dailySummary+"\" width=\"70\" height=\"50\">";
                break;
        case "cloudy" : 
            imageTab3="<img src=\"Web8_images/cloudy.png\" alt=\""+dailySummary+"\" title=\""+dailySummary+"\" width=\"70\" height=\"50\">"; 
            break;
        case "partly-cloudy-day" :
            imageTab3="<img src=\"Web8_images/cloud_day.png\" alt=\""+dailySummary+"\" title=\""+dailySummary+"\" width=\"70\" height=\"50\">"; 
            break;
        case "partly-cloudy-night" : 
            imageTab3="<img src=\"Web8_images/cloud_night.png\" alt=\""+dailySummary+"\" title=\""+dailySummary+"\" width=\"70\" height=\"50\">"; 
            break;
  
                        }
                        
                         switch(dailyIcon)
                        {
                                case "clear-day": 
            modalIcon="<img src=\"Web8_images/clear.png\" alt=\""+dailySummary+"\" title=\""+dailySummary+"\" width=\"150\" height=\"150\">";
            break;
        case "clear-night" : 
            modalIcon="<img src=\"Web8_images/clear_night.png\" alt=\""+dailySummary+"\" title=\""+dailySummary+"\" width=\"150\" height=\"150\">";
                break;
        case "rain" : 
            modalIcon="<img src=\"Web8_images/rain.png\" alt=\""+dailySummary+"\" title=\""+dailySummary+"\" width=\"150\" height=\"150\">";
            break;
        case "snow" : 
            modalIcon="<img src=\"Web8_images/snow.png\" alt=\""+dailySummary+"\" title=\""+dailySummary+"\" width=\"150\" height=\"150\">";
                break;
        case "sleet" :
            modalIcon="<img src=\"Web8_images/sleet.png\" alt=\""+dailySummary+"\" title=\""+dailySummary+"\" width=\"150\" height=\"150\">";
            break;
        case "wind" : 
            modalIcon="<img src=\"Web8_images/wind.png\" alt=\""+dailySummary+"\" title=\""+dailySummary+"\" width=\"150\" height=\"150\">";
            break;
        case "fog" :
            modalIcon="<img src=\"Web8_images/fog.png\" alt=\""+dailySummary+"\" title=\""+dailySummary+"\" width=\"150\" height=\"150\">";
                break;
        case "cloudy" : 
            modalIcon="<img src=\"Web8_images/cloudy.png\" alt=\""+dailySummary+"\" title=\""+dailySummary+"\" width=\"150\" height=\"150\">";
            break;
        case "partly-cloudy-day" :
            modalIcon="<img src=\"Web8_images/cloud_day.png\" alt=\""+dailySummary+"\" title=\""+dailySummary+"\" width=\"150\" height=\"150\">";
            break;
        case "partly-cloudy-night" : 
            modalIcon="<img src=\"Web8_images/cloud_night.png\" alt=\""+dailySummary+"\" title=\""+dailySummary+"\" width=\"150\" height=\"150\">";
            break;
  
                        }
                        
                 
                        
tab3+="<button type=\"button\" class=\"btn btn-lg col-lg-1 col-md-1 col-sm-12 col-xs-12\" data-toggle=\"modal\"data-target=\"#myModal"+i+"\" id=\"tab3btn"+i+"\" style=\"color:white;background-color:"+colors[i]+";margin:5px;padding:0px\" text-center><span style=\"font-size:75%; font-weight:bold\">"+day+"<br><br>"+date+"</span><br>"+imageTab3+"<br><span style=\"font-size:75%\">Min<br>Temp<br><br></span><span style=\" font-size:150%; font-weight:bold\"> "+tempMin+"&deg</span><br><br><span style=\"font-size:75%\">Max<br>Temp<br><br></span><span style=\" font-size:150%; font-weight:bold\">"+tempMax+"&deg</span><br></button>";

tab3Modal+="<div class=\"modal fade\" id=\"myModal"+i+"\" role=\"dialog\"><div class=\"modal-dialog\"><div class=\"modal-content\"><div class=\"modal-header\"><button type=\"button\" class=\"close\" data-dismiss=\"modal\">&times;</button><h4 class=\"modal-title\">Weather in "+city+" on "+date+"</h4></div><div class=\"modal-body text-center\">"+modalIcon+"<br>";
tab3Modal+="<div class=\"text-center\"><span style=\"font-size:150%;font-weight:150%\">"+day+":</span>"+"<span style=\"color:#F9BC29; font-size: 150%; font-weight: bold;\">"+dailySummary+"</span></div><br>";

                    
tab3Modal+="<div class=\"row\"><div class=\"col-lg-4 col-md-4 col-sm-12 col-xs-12 text-center\" style=\"padding:5px\"><span style=\"font-weight: bold;\">Sunrise Time</span><br/>"+dailySunrise+"</div><div class=\"col-lg-4 col-md-4 col-sm-12 col-xs-12 text-center\" style=\"padding:5px\"><span style=\"font-weight: bold;\">Sunset Time</span><br/>"+dailySunset+"</div><div class=\"col-lg-4 col-md-4 col-sm-12 col-xs-12 text-center\" style=\"padding:5px\"><span style=\"font-weight: bold;\">Humidity</span><br/>"+dailyHumidity+"</div></div><div class=\"row\"><div class=\"col-lg-4 col-md-4 col-sm-12 col-xs-12 text-center\" style=\"padding:5px\"><span style=\"font-weight: bold;\">Wind Speed</span><br/>"+dailyWindSpeed+windSpeedUnit+"</div><div class=\"col-lg-4 col-md-4 col-sm-12 col-xs-12 text-center\" style=\"padding:5px\"><span style=\"font-weight: bold;\" style=\"padding:5px\">Visibility</span><br/>"+dailyVisibility+tab3VisibilityUnit+"</div><div class=\"col-lg-4 col-md-4 col-sm-12 col-xs-12 text-center\" style=\"padding:5px\"><span style=\"font-weight: bold;\">Pressure</span><br/>"+dailypressure+pressureUnit+"</div></div><div class=\"modal-footer\"><button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button></div></div></div></div></div>";
                    
                        
                    }
                    
                    tab3Data=tab3.concat(tab3Modal);
                    
                    
                    
                    table2+="</tbody></table>";   
                    iconDisp+=displayIcon;
                    document.getElementById("printTab1").innerHTML=iconDisp;
                    document.getElementById("temp").innerHTML=printTemp;
                    document.getElementById("displayTable").innerHTML=table1;
                    document.getElementById("tab2").innerHTML=table2;
                    document.getElementById("displayTab3").innerHTML=tab3Data;
// Facebook post
        
    window.fbAsyncInit = function() {
    FB.init({
      appId      : '602063069931910',
      xfbml      : true,
      version    : 'v2.5'
    });
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
       
        document.getElementById("fbButton").onclick= function facebookfunction() 
        {
				FB.ui(
				{
					method: 'feed',
					name: 'Current weather in '+city+' ,'+state,
					link: "http://forecast.io" ,
					caption: 'WEATHER INFORMATION FROM FORCAST.IO',
					description:summary+', '+temp+"&deg;"+tempUnit, //clear,78 deg C
					message:"works",
                    picture: fbIcon,
				},  
				 // callback
				function(response) 
				{
					if (response && !response.error_message) 
					{
						alert('Posted Successfully.');
					} 
					else 
					{
						alert('Not Posted.');
					}
				});
			
			}
        
//Map here
        
        var lat=obj["latitude"];
        var long= obj["longitude"]; 
        $('#map').empty();
    var fromProjection = new OpenLayers.Projection("EPSG:4326");   // Transform from WGS 1984
        var toProjection   = new OpenLayers.Projection("EPSG:900913"); // to Spherical Mercator Projection
        var position       = new OpenLayers.LonLat(long,lat).transform( fromProjection, toProjection);
                    

    var map = new OpenLayers.Map("map");
                    
    // Create OSM overlays
    var mapnik = new OpenLayers.Layer.OSM();

          var layer_cloud = new OpenLayers.Layer.XYZ(
        "clouds",
        "http://${s}.tile.openweathermap.org/map/clouds/${z}/${x}/${y}.png",
        {
            isBaseLayer: false,
            opacity: 0.5,
            sphericalMercator: true
        }
    );

    var layer_precipitation = new OpenLayers.Layer.XYZ(
        "precipitation",
        "http://${s}.tile.openweathermap.org/map/precipitation/${z}/${x}/${y}.png",
        {
            isBaseLayer: false,
            opacity: 0.5,
            sphericalMercator: true
        }
    );
        
                    map.addLayers([mapnik, layer_precipitation, layer_cloud]);
                map.setCenter(position,10);

            });
       
    });
 });
         
         
                function resetVlaues(){
                    
                    
                    
                    $('#dataFind').addClass('hidden');
                    $('#catchError').addClass('hidden');
                    var clearValues=document.getElementById("stAddr");
                    clearValues.value="";
                    clearValues=document.getElementById("city");
                    clearValues.value="";                    
                    clearValues=document.getElementById("state");
                    clearValues.selectedIndex=clearValues.defaultSelected;
                    clearValues=document.getElementById("degree");
                    clearValues.checked=clearValues.defaultChecked;

                }
         
        </script>
    </head>
<body>
 
    <h2><font color="black"> Forecast Search</font></h2>
    
    <div class="container">
        <fieldset class="fieldset">
    <form id="myForm" role="form" method="get">

            <div class="form-group col-sm-12 col-md-3 col-lg-3" style="padding-right:2px;padding-left:2px">
            
                <label class="control-label" for="stAddr"><font color="white">Street Address:</font><font color="red">*</font></label>
                <input type="text" class="form-control" id="stAddr" name="stAddr" placeholder="Enter street address" size="35"  >

            </div>
            
            <div class="form-group col-sm-12 col-md-2 col-lg-2" style="padding-right:2px;padding-left:2px">
          
                <label class="control-label" for="city"><font color="white">City:</font><font color="red">*</font></label>
                <input type="text" class="form-control" name="city" id="city" placeholder="Enter the city name" >
            </div>
            <div class="form-group col-sm-12 col-md-2 col-lg-2" style="padding-right:2px;padding-left:2px">
            
                <label class="control-label" for="state"><font color="white">State:</font><font color="red">*</font></label><br>
                <select name="state" id="state" class="form-control" >
                    <option value="0">Select your state</option>
                    <option value="AL">Alabama</option>
                    <option value="AK">Alaska</option>
                    <option value="AZ">Arizona</option>
                    <option value="AR">Arkansas</option>
                    <option value="CA">California</option>
                    <option value="CO">Colorado</option>
                    <option value="CO">Colorado</option>
                    <option value="CT">Connecticut</option>
                    <option value="DE">Delaware</option>
                    <option value="DC">District of Columbia</option>
                    <option value="FL">Florida</option>
                    <option value="GA">Georgia</option>
                    <option value="HI">Hawaii</option>
                    <option value="ID">Idaho</option>
                    <option value="IL">Illinois</option>
                    <option value="IN">Indiana</option>
                    <option value="IA">Iowa</option>
                    <option value="KS">Kansas</option>
                    <option value="KY">Kentucky</option>
                    <option value="LA">Louisiana</option>
                    <option value="ME">Maine</option>
                    <option value="MD">Maryland</option>
                    <option value="MA">Massachusetts</option>
                    <option value="MI">Michigan</option>
                    <option value="MN">Minnesota</option>
                    <option value="MS">Mississippi</option>
                    <option value="MO">Missouri</option>
                    <option value="MT">Montana</option>
                    <option value="NE">Nebraska</option>
                    <option value="NV">Nevada</option>
                    <option value="NH">New Hampshire</option>
                    <option value="NJ">New Jersey</option>
                    <option value="NM">New Mexico</option>
                    <option value="NY">New York</option>
                    <option value="NC">North Carolina</option>
                    <option value="ND">North Dakota</option>
                    <option value="OH">Ohio</option>
                    <option value="OK">Oklahoma</option>
                    <option value="OR">Oregon</option>
                    <option value="PA">Pennsylvania</option>
                    <option value="RI">Rhode Island</option>
                    <option value="SC">South Carolina</option>
                    <option value="SD">South Dakota</option>
                    <option value="TN">Tennessee</option>
                    <option value="TX">Texas</option>
                    <option value="UT">Utah</option>
                    <option value="VT">Vermont</option>
                    <option value="VA">Virginia</option>
                    <option value="WA">Washington</option>
                    <option value="WV">West Virginia</option>
                    <option value="WI">Wisconsin</option>
                    <option value="WY">Wyoming</option>
                </select>
            </div>
            <div class="form-group col-sm-12 col-md-5 col-lg-5">
                <div class="form-group col-sm-12 col-md-6 col-lg-6" style="padding:0px">
                <label for="degree"><font color="white">Degree:</font><font color="red">*</font></label>
                <div class="radio">
                
                    <label class="radio-inline"><input type="radio" id="degree" name="degree" value="fahrenheit" checked="checked"><font color="white">Fahrenheit</font></label>
                   
                        <label class="radio-inline"><input type="radio" id="degree"  name="degree" value="celsius" ><font color="white">Clesius</font></label>
                </div>
</div><br>
                 <div class="form-group col-sm-12 col-md-6 col-lg-6" style="padding:0px">
                <button type="button" class="btn btn-default pull-right" onclick="resetVlaues();"><span class="glyphicon glyphicon-refresh"></span>Clear</button>
                <button type="submit" class="btn btn-primary pull-right"><span class="glyphicon glyphicon-search"></span>Search</button>
                     
                </div>
            
            </div>
        </form>
        <br>
        <div class="row"> 
            <div class="col-sm-12 col-md-12 col-lg-12"><span class="pull-right"><font color="white">Powered by:</font>
                <a href="http://forecast.io/"><img src="Web8_images/forecast_logo.png" width="100px" height="50px" /></a>
                </span></div></div>

            
        </fieldset>
        <hr color="white">  
        
        <center>
           <div id="catchError" class="errorcatch hidden" style="font-weight: bold; background-color: white;"></div>
           </center>
        <div class="clear hidden" id="dataFind">
               <div>
    <ul class="nav nav-tabs">
            <li class="active"><a data-toggle="tab" href="#tab1">Right Now</a></li>
            <li><a data-toggle="tab" href="#tab2">Next 24 hours</a></li>
            <li><a data-toggle="tab" href="#tab3">Next 7 days</a></li>
    </ul>
        
        <div class="tab-content">
            <div id="tab1" class="tab-pane active" style="padding:0">
                
                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12" style="padding:0">
                <div class="col-lg-12 col-md-12" style="padding:0">
                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12"  style="background-color: #ff6666" >
                <div id="printTab1" align="center" style="padding:0"></div> 
                </div>
                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12" style="padding:9;background-color: #ff6666;font-size:12px;font-weight:bold" >
                <div id="temp" align="center"></div>
                </div>
                </div>

                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="padding:0">
                <div id="displayTable"></div>
                </div>
                </div>
                
                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12" id="map" style="height:420px;">
                </div>
                </div>

            <div id="tab2" class="tab-pane fade"> </div>
                
            <div id="tab3" class="tab-pane fade" style="background-color:black">
            <div class="col-lg-12 col-md-12" style="background-color:black">
                <div class='col-sm-12 col-xs-12' style='padding:0px'>
                <div class="col-lg-2 col-md-2"></div>
                
                <div id="displayTab3" style="padding:0"></div>
                <div class="col-lg-3 col-md-3"></div>
                </div>
            </div>
            </div>
            </div>
    </div>
    </div>
        </div>
    </body>
</html>


  
